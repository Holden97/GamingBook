# 武器同步

## 为什么使武器不继承NetworkBehaviour？

1. 如果所有武器都是网络物体，那么在获取当前枪支时，要在NetworkIdentity和Weapon之间来回转换，以我目前的水平，很容易写错。
2. 因为将武器作为了NetworkBehaviour，所以这一部分也会被同步，增大了对网络的要求，但收益目前不明显。
3. 武器的创建过程交给服务器处理，那么服务器统一创建是通过Spawn方法进行的，如果客户端想在该武器被创建时进行一些操作，就必须写在OnStartClient方法中。客户端中的WeaponSystem就无法准确知晓其在何时被完全创建。如果要做到这一点，需要通过发送事件，代码会变得臃肿不优雅。
4. 同步中的一个原则是逻辑和表现分离，加载预设这种耗时的操作不应该出现在同步消息中。
5. 网络物体在客户端生成时，不会以认为物体为父节点，而是会作为根节点在客户端生成；武器作为人物跟随移动的一部分，应该有其父节点。使用NetworkTransformChild需要在运行前指定其父节点，但项目中武器的模型是动态生成的，无法在运行前指定父节点。这两个特点决定了武器使用NetworkBehaviour事倍功半。
6. 实际上数据层面就是应该使用NetworkBehaviour使之同步，现在出现的问题是数据与表现没有完全分开。之后再设计时，应该注意将人物的数据和表现（物体）完全分开，才不会出现类似数据中夹杂着需要等待预设加载的问题。

## 使用MonoBehaviour需要注意什么？

Weapon需要同步当前弹夹数量和当前子弹数量，这两个数据可以放在一个结构体中，可以先尝试使用List在服务器中写。
